layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index"),
# margin = list(l = 50, r = 50)
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1, titleX = TRUE) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index")
# margin = list(l = 50, r = 50)
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1, titleX = TRUE) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index"),
margin = list(l = 50, r = 50)
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1, titleX = TRUE) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index")
# margin = list(l = 50, r = 50)
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index")
# margin = list(l = 50, r = 50)
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index", side = "right"),
margin = list(l = 50, r = 50)
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index")
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1, margin = 0.05) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index")
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1, margin = 0.01) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index")
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1, margin = 0.04) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index")
)
}
invasion_plot(2576335)
# Create invasion plot
invasion_plot <- function(match_id) {
# Load invasion datasets for specified match
invasion_home <- read_csv(paste0('data/invasion/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
invasion_away <- read_csv(paste0('data/invasion/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Invasion_RA = rollapply(Invasion, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Load acceleration datasets for specified match
acceleration_home <- read_csv(paste0('data/acceleration/', match_id, '_home.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
acceleration_away <- read_csv(paste0('data/acceleration/', match_id, '_away.csv')) %>%
select(-1) %>%
mutate(
Time = Time / 60,
Acceleration_RA = rollapply(Acceleration, width = 220, FUN = mean, fill = NA, align = "right", partial = TRUE)
)
# Create ggplot object
invasion_plot <- ggplotly(
ggplot() +
geom_line(data = invasion_home, aes(x = Time, y = Invasion_RA), color = home_color) +
geom_line(data = invasion_away, aes(x = Time, y = Invasion_RA), color = away_color) +
labs(y = "Invasion Index")
)
# Create ggplot object
acceleration_plot <- ggplotly(
ggplot() +
geom_line(data = acceleration_home, aes(x = Time, y = Acceleration_RA), color = home_color) +
geom_line(data = acceleration_away, aes(x = Time, y = Acceleration_RA), color = away_color) +
labs(y = "Acceleration Index")
)
# Align the plots horizontally
subplot(invasion_plot, acceleration_plot, nrows = 1, margin = 0.05) %>%
layout(
yaxis = list(title = "Invasion Index"),
yaxis2 = list(title = "Acceleration Index")
)
}
invasion_plot(2576335)
